import{d as ut,g as ht,r as o,h as mt,j as e,i as gt,k as xt,m as ft,T as r,R as bt,q as pt,s as A,B as m,c as f,z as We,b as u,L as re,w as Y,C as jt,a as yt,y as V,M as vt,I as wt}from"./index-3v-V_ujV.js";import{u as St,a as Ct}from"./usePageTitle-seETqNZq.js";import{A as Tt}from"./Add-BLHWnkwj.js";import{D as Rt}from"./Delete-CFLk6tfJ.js";import{A as y}from"./Alert-Cd_pZj5V.js";import{T as le,a as ce,b as de,c as S,d as l,e as ue}from"./TableRow-Ch5q5_jA.js";import{D as F,a as Z,b as K,c as Q}from"./DialogTitle-DjXGIgXC.js";import{T as p,F as kt,I as Dt,S as It,b as _t}from"./TextField-D9X8XuqD.js";import{F as X}from"./FormControlLabel-XVNslV9S.js";import{C as Le}from"./Checkbox-B8l9FLC_.js";import{G as ee}from"./Grid-CWEeYFsZ.js";import{R as Pt,a as Ae}from"./RadioGroup-B8f7XhuI.js";import"./Close-BLRrZJzV.js";import"./useControlled-2upcAsfy.js";import"./isMuiElement-Dd43ylT-.js";function Wt(c){return ut("MuiDialogContentText",c)}ht("MuiDialogContentText",["root"]);const Lt=c=>{const{classes:h}=c,C=ft({root:["root"]},Wt,h);return{...h,...C}},At=gt(r,{shouldForwardProp:c=>bt(c)||c==="classes",name:"MuiDialogContentText",slot:"Root"})({}),Fe=o.forwardRef(function(h,a){const C=mt({props:h,name:"MuiDialogContentText"}),{children:g,className:te,...I}=C,E=Lt(I);return e.jsx(At,{component:"p",variant:"body1",color:"textSecondary",ref:a,ownerState:I,className:xt(E.root,te),...C,classes:E})}),Oe=pt(e.jsx("path",{d:"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6z"})),D="https://tutor-matching-backend.onrender.com";function Me(c,h=!1){if(!c)return{type:"Unknown",display:"Location not specified",color:"default"};const a=c.toLowerCase().trim();if(a==="online"||a.includes("zoom")||a.includes("online"))return{type:"🌐 Online",display:"Online Session via Zoom",color:"info",fullLocation:c};if(a.includes("library")||a.includes("public library")||a.includes("local library")||a.includes("state library")||a.includes("council library"))return{type:"📚 Library",display:h?c:"Library session (full location revealed upon acceptance)",color:"secondary",fullLocation:c};{const g=h?c:Ft(c);return{type:"🏠 In-Home",display:h?c:`In-home session in ${g} (full address revealed upon acceptance)`,color:"warning",fullLocation:c}}}function Ft(c){if(!c)return"Unknown area";const h=c.split(",").map(a=>a.trim());if(h.length>=2)return h[h.length-2].replace(/\d+/g,"").trim()||"General area";if(h.length===1){const a=c.trim().split(" ");return a.slice(0,Math.min(3,a.length)).join(" ").replace(/\d+/g,"").trim()||"General area"}return"General area"}function Kt(){const[c,h]=o.useState(!0),[a,C]=o.useState(null),[g,te]=o.useState(null),[I,E]=o.useState([]),[he,Ne]=o.useState([]),[T,me]=o.useState(null),[ge,O]=o.useState(null),[xe,M]=o.useState(""),$={success:t=>M(t),error:t=>O(t),info:t=>M(t),warning:t=>M(t)};St(g?`${g.full_name||"Tutor"} Dashboard`:"Tutor Dashboard"),o.useEffect(()=>{Ct("tutor")},[]);const[fe,Ee]=o.useState([]),[$e,se]=o.useState({}),[be,ze]=o.useState([]),[qe,pe]=o.useState(!1),[je,ye]=o.useState(null),[v,z]=o.useState([]),[ve,ne]=o.useState(""),[Ue,Ge]=o.useState(!1),[Je,we]=o.useState(!1),[Be,Se]=o.useState(!1),[He,q]=o.useState(!1),[Ye,U]=o.useState(!1),[_,P]=o.useState(null),[G,Ce]=o.useState(""),[J,Te]=o.useState(""),[b,w]=o.useState(!1),[d,W]=o.useState({diagnosticAssessment:"",improvementSuggestions:"",nextLessonPlan:"",attachedResourceIds:[],usageNotes:""}),[x,N]=o.useState({teachingReflection:"",longTermProgram:"",attachedResourceIds:[],usageNotes:""}),[B,Ve]=o.useState([]),[Re,ke]=o.useState(!1),R=o.useCallback(async t=>{try{O(null);const{data:s,error:n}=await A.from("outreach_attempts").select("id, trial_sessions:session_id(*, trial_lessons(*, subjects(name)))").eq("tutor_id",t).eq("status","pending");if(n)throw new Error(`Failed to load pending requests: ${n.message}`);E(s||[]);const{data:i,error:j}=await A.from("trial_sessions").select("*, trial_lessons(*, subjects(name))").eq("assigned_tutor_id",t).in("status",["Confirmed","Trial 1 Complete - Diagnostic Submitted","Trial 2 Complete - Reflection Submitted","Student Continuing - Awaiting Schedule"]);if(j)throw new Error(`Failed to load confirmed trials: ${j.message}`);Ne(i||[]);const{data:L,error:k}=await A.from("trial_sessions").select("*, trial_lessons(*, subjects(name)), session_waitlist(*)").in("status",["Outreach in Progress","Confirmed"]).not("assigned_tutor_id","eq",t);if(k)throw new Error(`Failed to load available sessions: ${k.message}`);Ee(L||[]);const{data:dt,error:Pe}=await A.from("trial_sessions").select("*, trial_lessons(*, subjects(name))").eq("assigned_tutor_id",t).eq("status","Student Continuing - Awaiting Schedule");if(Pe)throw new Error(`Failed to load continuing sessions: ${Pe.message}`);ze(dt||[])}catch(s){console.error("Error fetching dashboard data:",s),O(s.message)}},[]);o.useEffect(()=>{(async()=>{h(!0);const{data:{session:s}}=await A.auth.getSession();if(s!=null&&s.user){const n=s.user.id;C(s.user);const{data:i}=await A.from("tutors").select("suburb, phone_number").eq("id",n).single();te(i),await R(n)}h(!1)})()},[R]);const Ze=()=>{Ge(!1),P(null)},Ke=async t=>{se(s=>({...s,[t]:"loading"}));try{const s=await fetch(`${D}/api/sessions/${t}/join-waitlist`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tutorId:a.id})}),n=await s.json();if(!s.ok)throw new Error(n.error||"Failed to join waitlist.");alert("You have successfully joined the waitlist!"),se(i=>({...i,[t]:"joined"}))}catch(s){alert("Error: "+s.message),se(n=>({...n,[t]:"error"}))}},Qe=t=>{P(t),we(!0)},Xe=()=>we(!1),ie=t=>{if(!t.status)return"diagnostic";const s=t.status.toLowerCase();return s.includes("confirmed")||s==="confirmed"?"diagnostic":s.includes("trial 1 complete")||s.includes("diagnostic")?"reflection":"regular"},et=t=>{const s=ie(t);P(t),s==="diagnostic"?rt(t):s==="reflection"?lt(t):Se(!0)},ae=()=>{Se(!1),Ce(""),Te(""),P(null)},tt=t=>{var s,n;if(ye(t),pe(!0),(n=(s=t.trial_lessons)==null?void 0:s[0])!=null&&n.lesson_datetime){const i=new Date(t.trial_lessons[0].lesson_datetime),j=i.toLocaleDateString("en-US",{weekday:"long"}),L=i.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});ne(`${j} at ${L} (Same as trial)`)}},oe=()=>{pe(!1),ye(null),z([]),ne("")},st=()=>{z([...v,{day:"",time:""}])},De=(t,s,n)=>{const i=[...v];i[t][s]=n,z(i)},nt=t=>{z(v.filter((s,n)=>n!==t))},it=async()=>{if(!(!je||v.length===0)){w(!0);try{const t=await fetch(`${D}/api/sessions/${je.id}/set-permanent-availability`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({availableSlots:v.filter(n=>n.day&&n.time),tutorId:a.id,preferredTime:ve})}),s=await t.json();if(!t.ok)throw new Error(s.error||"Failed to submit availability.");alert("Availability submitted successfully! Admin will contact you to confirm the permanent lesson time."),await R(a.id),oe()}catch(t){alert("Error: "+t.message)}w(!1)}},Ie=o.useCallback(async(t=[])=>{ke(!0);try{const s=new URLSearchParams;t.length>0&&s.append("subjectId",t[0]);const n=await fetch(`${D}/api/resources/for-feedback?${s}`),i=await n.json();n.ok?Ve(i.resources||[]):console.error("Error fetching resources:",i.error)}catch(s){console.error("Failed to fetch resources:",s)}finally{ke(!1)}},[]),at=async()=>{if(!_||!a)return;const t=d.diagnosticAssessment.trim().split(/\s+/).length,s=d.improvementSuggestions.trim().split(/\s+/).length,n=d.nextLessonPlan.trim().split(/\s+/).length;if(t<40){alert("Diagnostic assessment must be at least 40 words.");return}if(s<30){alert("Improvement suggestions must be at least 30 words.");return}if(n<30){alert("Next lesson plan must be at least 30 words.");return}if(!d.diagnosticAssessment||!d.improvementSuggestions||!d.nextLessonPlan){alert("All diagnostic fields are required.");return}w(!0);try{const i=await fetch(`${D}/api/sessions/${_.id}/submit-diagnostic-enhanced`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tutorId:a.id,diagnosticAssessment:d.diagnosticAssessment,improvementSuggestions:d.improvementSuggestions,nextLessonPlan:d.nextLessonPlan,attachedResourceIds:d.attachedResourceIds,usageNotes:d.usageNotes})}),j=await i.json();i.ok?(alert("Diagnostic feedback submitted successfully!"),q(!1),W({diagnosticAssessment:"",improvementSuggestions:"",nextLessonPlan:"",attachedResourceIds:[],usageNotes:""}),await R(a.id)):alert("Error: "+(j.error||"Failed to submit diagnostic"))}catch(i){console.error("Error submitting diagnostic:",i),alert("Failed to submit diagnostic feedback")}finally{w(!1)}},ot=async()=>{if(!(!_||!a)){if(!x.teachingReflection||!x.longTermProgram){alert("All reflection fields are required.");return}w(!0);try{const t=await fetch(`${D}/api/sessions/${_.id}/submit-reflection-enhanced`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tutorId:a.id,teachingReflection:x.teachingReflection,longTermProgram:x.longTermProgram,attachedResourceIds:x.attachedResourceIds,usageNotes:x.usageNotes})}),s=await t.json();t.ok?(alert("Reflection feedback submitted successfully!"),U(!1),N({teachingReflection:"",longTermProgram:"",attachedResourceIds:[],usageNotes:""}),await R(a.id)):alert("Error: "+(s.error||"Failed to submit reflection"))}catch(t){console.error("Error submitting reflection:",t),alert("Failed to submit reflection feedback")}finally{w(!1)}}},_e=(t,s)=>{s==="diagnostic"?W(n=>({...n,attachedResourceIds:n.attachedResourceIds.includes(t)?n.attachedResourceIds.filter(i=>i!==t):[...n.attachedResourceIds,t]})):s==="reflection"&&N(n=>({...n,attachedResourceIds:n.attachedResourceIds.includes(t)?n.attachedResourceIds.filter(i=>i!==t):[...n.attachedResourceIds,t]}))},rt=t=>{var n;P(t),q(!0);const s=((n=t.trial_lessons)==null?void 0:n.map(i=>i.subject_id))||[];Ie(s)},lt=t=>{var n;P(t),U(!0);const s=((n=t.trial_lessons)==null?void 0:n.map(i=>i.subject_id))||[];Ie(s)},ct=async()=>{if(!(!_||!G||!J)){w(!0);try{const t=J==="successful",s=await fetch(`${D}/api/sessions/${_.id}/submit-feedback`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({feedback:G,tutorId:a.id,wasSuccessful:t})}),n=await s.json();if(!s.ok)throw new Error(n.error||"Failed to submit feedback.");alert("Lesson feedback submitted successfully!"),await R(a.id),ae()}catch(t){alert("Error: "+t.message)}w(!1)}},H=async(t,s)=>{if(!T){me(t),O(null),M("");try{const n=await fetch(`${D}/api/outreach-attempts/${t}/respond`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({response:s})}),i=await n.json();if(!n.ok)throw new Error(i.error||"Failed to submit response");s==="accepted"?$.success("Session accepted! We'll send you meeting details and student information shortly.",{title:"Session Confirmed",duration:8e3}):s==="declined"?$.info("Response recorded. We'll continue finding the right match for this student.",{title:"Response Submitted",duration:5e3}):s==="require_different_time"&&$.warning("Time change request noted. An admin will review and contact you about alternative times.",{title:"Rescheduling Request",duration:7e3}),await R(a.id)}catch(n){console.error("Error responding to request:",n),$.error(`Failed to submit response: ${n.message}`,{title:"Response Failed",action:e.jsx(u,{size:"small",onClick:()=>H(t,s),sx:{color:"white"},children:"Retry"})})}finally{me(null)}}};return c?e.jsx(m,{sx:{display:"flex",justifyContent:"center",mt:4},children:e.jsx(f,{})}):e.jsxs(m,{sx:{p:3},children:[e.jsxs(m,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(r,{variant:"h4",gutterBottom:!0,children:["Welcome back, ",(g==null?void 0:g.full_name)||(a==null?void 0:a.email)||"Tutor","! 👋"]}),e.jsxs(We,{direction:"row",spacing:2,children:[e.jsx(u,{component:re,to:"/tutor/resources",variant:"contained",color:"secondary",children:"Resource Hub"}),e.jsx(u,{component:re,to:"/tutor/profile",variant:"contained",children:"Edit Profile"})]})]}),ge&&e.jsx(y,{severity:"error",sx:{mb:2},onClose:()=>O(null),children:ge}),xe&&e.jsx(y,{severity:"success",sx:{mb:2},onClose:()=>M(""),children:xe}),g&&(!g.suburb||!g.phone_number)&&e.jsxs(y,{severity:"warning",sx:{mb:3},children:[e.jsx("strong",{children:"Profile Incomplete:"})," Please update your profile with your suburb and phone number to receive trial requests.",e.jsx(u,{component:re,to:"/tutor/profile",size:"small",sx:{ml:2},children:"Complete Profile"})]}),e.jsxs(Y,{sx:{p:3,mb:3},children:[e.jsxs(r,{variant:"h5",gutterBottom:!0,color:"primary",children:["📩 Pending Trial Requests (",I.length,")"]}),I.length===0?e.jsxs(m,{textAlign:"center",py:4,children:[e.jsx(r,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No pending requests at the moment"}),e.jsx(r,{variant:"body2",color:"text.secondary",children:"We'll notify you when new trial opportunities become available that match your subjects."})]}):I.map(t=>{var L;const s=t.trial_sessions;if(!((L=s==null?void 0:s.trial_lessons)!=null&&L.length))return null;const n=Me(s.location,!1),i=s.trial_lessons[0],j=new Date(i.lesson_datetime);return e.jsx(jt,{sx:{mb:2,border:"2px solid",borderColor:"primary.light"},children:e.jsxs(yt,{children:[e.jsxs(m,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2,children:[e.jsxs(m,{flex:1,children:[e.jsxs(r,{variant:"h6",color:"primary",gutterBottom:!0,children:[s.trial_lessons.map(k=>k.subjects.name).join(", ")," Trial"]}),e.jsxs(r,{variant:"body1",fontWeight:"bold",children:["📅 ",j.toLocaleDateString("en-AU",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]}),e.jsxs(r,{variant:"body1",children:["⏰ ",j.toLocaleTimeString("en-AU",{hour:"2-digit",minute:"2-digit"})," (",i.duration_minutes," minutes)"]}),e.jsx(V,{label:n.display,color:n.color,size:"medium",sx:{mt:1,fontWeight:"bold"}})]}),e.jsxs(m,{textAlign:"right",children:[e.jsxs(r,{variant:"body2",color:"text.secondary",children:["Parent: ",s.parent_name]}),e.jsxs(r,{variant:"body2",color:"text.secondary",children:["Students: ",s.trial_lessons.map(k=>`${k.student_name} (${k.student_grade})`).join(", ")]})]})]}),e.jsxs(m,{display:"flex",gap:2,flexWrap:"wrap",children:[e.jsx(u,{variant:"contained",color:"success",size:"large",onClick:()=>H(t.id,"accepted"),disabled:T===t.id,sx:{minWidth:120},children:T===t.id?e.jsx(f,{size:20}):"✅ Accept"}),e.jsx(u,{variant:"outlined",color:"warning",size:"large",onClick:()=>H(t.id,"require_different_time"),disabled:T===t.id,sx:{minWidth:160},children:T===t.id?e.jsx(f,{size:20}):"🔄 Different Time"}),e.jsx(u,{variant:"outlined",color:"error",size:"large",onClick:()=>H(t.id,"declined"),disabled:T===t.id,sx:{minWidth:120},children:T===t.id?e.jsx(f,{size:20}):"❌ Decline"})]}),e.jsx(y,{severity:"info",sx:{mt:2},children:e.jsxs(r,{variant:"body2",children:["💡 ",e.jsx("strong",{children:"Need a different time?"}),' Click "Different Time" and an admin will contact you to discuss alternatives.']})})]})},t.id)})]}),be.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"h5",sx:{mt:4,mb:2,color:"success.main"},children:"🎉 Students Continuing - Set Your Availability"}),e.jsx(y,{severity:"success",sx:{mb:2},children:"Great news! These students want to continue with permanent lessons. Please set your available times so we can schedule ongoing sessions."}),e.jsx(le,{component:Y,children:e.jsxs(ce,{children:[e.jsx(de,{children:e.jsxs(S,{children:[e.jsx(l,{children:"Student & Subjects"}),e.jsx(l,{children:"Original Trial Time"}),e.jsx(l,{children:"Actions"})]})}),e.jsx(ue,{children:be.map(t=>e.jsxs(S,{children:[e.jsxs(l,{children:[e.jsx(r,{variant:"body1",sx:{fontWeight:"bold"},children:t.trial_lessons.map(s=>s.student_name).join(", ")}),e.jsx(r,{variant:"body2",color:"textSecondary",children:t.trial_lessons.map(s=>s.subjects.name).join(", ")})]}),e.jsx(l,{children:t.trial_lessons[0]?new Date(t.trial_lessons[0].lesson_datetime).toLocaleString():"Time not specified"}),e.jsx(l,{children:e.jsx(u,{variant:"contained",color:"success",onClick:()=>tt(t),children:"Set Availability"})})]},t.id))})]})})]}),e.jsx(r,{variant:"h5",sx:{mt:4,mb:2},children:"Your Confirmed Trials"}),e.jsx(le,{component:Y,children:e.jsxs(ce,{children:[e.jsx(de,{children:e.jsxs(S,{children:[e.jsx(l,{children:"Subjects"}),e.jsx(l,{children:"Location"}),e.jsx(l,{children:"Status"}),e.jsx(l,{children:"Actions"})]})}),e.jsx(ue,{children:he.length>0?he.map(t=>e.jsxs(S,{children:[e.jsx(l,{children:t.trial_lessons.map(s=>s.subjects.name).join(", ")}),e.jsx(l,{children:(()=>{const s=Me(t.location,!0);return e.jsxs(m,{children:[e.jsx(V,{label:s.type,color:s.color,variant:"filled",size:"small",sx:{fontWeight:"bold",mb:.5}}),e.jsx(r,{variant:"body2",sx:{fontWeight:500},children:s.display})]})})()}),e.jsx(l,{children:e.jsx(V,{label:t.status,color:t.status==="Confirmed"?"success":"default",size:"small"})}),e.jsx(l,{children:t.status==="Confirmed"?e.jsxs(We,{direction:"row",spacing:1,children:[e.jsx(u,{variant:"outlined",color:"error",size:"small",onClick:()=>Qe(t),children:"Cancel"}),e.jsx(u,{variant:"contained",size:"small",onClick:()=>et(t),children:ie(t)==="diagnostic"?"Submit Diagnostic":ie(t)==="reflection"?"Submit Reflection":"Submit Feedback"})]}):e.jsx(y,{severity:"success",variant:"outlined",sx:{py:.5},children:t.status.replace("Completed - ","")})})]},t.id)):e.jsx(S,{children:e.jsx(l,{colSpan:4,align:"center",sx:{py:3},children:"You have no confirmed trials."})})})]})}),e.jsx(r,{variant:"h5",sx:{mt:4,mb:2},children:"Available Session Waitlists"}),e.jsx(le,{component:Y,children:e.jsxs(ce,{children:[e.jsx(de,{children:e.jsxs(S,{children:[e.jsx(l,{children:"Subjects"}),e.jsx(l,{children:"Location"}),e.jsx(l,{children:"Status"}),e.jsx(l,{align:"right",children:"Actions"})]})}),e.jsx(ue,{children:fe.length>0?fe.map(t=>{const s=t.session_waitlist.some(i=>i.tutor_id===a.id),n=$e[t.id];return e.jsxs(S,{children:[e.jsx(l,{children:t.trial_lessons.map(i=>i.subjects.name).join(", ")}),e.jsx(l,{children:t.location}),e.jsx(l,{children:e.jsx(V,{label:t.status,size:"small"})}),e.jsx(l,{align:"right",children:e.jsxs(u,{variant:"contained",color:"secondary",size:"small",disabled:s||n==="joined"||n==="loading",onClick:()=>Ke(t.id),children:[n==="loading"&&e.jsx(f,{size:20,color:"inherit"}),n!=="loading"&&(s||n==="joined"?"On Waitlist":"Join Waitlist")]})})]},t.id)}):e.jsx(S,{children:e.jsx(l,{colSpan:4,align:"center",sx:{py:3},children:"There are no available sessions to join a waitlist for."})})})]})}),e.jsx(F,{open:Ue,onClose:Ze}),e.jsx(F,{open:Je,onClose:Xe}),e.jsxs(F,{open:He,onClose:()=>q(!1),maxWidth:"md",fullWidth:!0,children:[e.jsxs(Z,{children:["📊 First Trial Lesson - Diagnostic Assessment",e.jsx(r,{variant:"subtitle2",color:"text.secondary",children:"Provide detailed feedback on the student's current abilities and learning needs"})]}),e.jsx(K,{children:e.jsxs(m,{sx:{mt:2},children:[e.jsx(p,{label:"Student Assessment (minimum 40 words)",multiline:!0,rows:4,fullWidth:!0,value:d.diagnosticAssessment,onChange:t=>W(s=>({...s,diagnosticAssessment:t.target.value})),placeholder:"Describe the student's current strengths, weaknesses, knowledge gaps, and overall performance during the lesson...",helperText:`${d.diagnosticAssessment.trim().split(/\s+/).filter(t=>t).length} words (minimum 40 required)`,sx:{mb:3}}),e.jsx(p,{label:"Improvement Suggestions (minimum 30 words)",multiline:!0,rows:3,fullWidth:!0,value:d.improvementSuggestions,onChange:t=>W(s=>({...s,improvementSuggestions:t.target.value})),placeholder:"Provide specific, actionable recommendations for areas where the student can improve...",helperText:`${d.improvementSuggestions.trim().split(/\s+/).filter(t=>t).length} words (minimum 30 required)`,sx:{mb:3}}),e.jsx(p,{label:"Next Lesson Plan (minimum 30 words)",multiline:!0,rows:3,fullWidth:!0,value:d.nextLessonPlan,onChange:t=>W(s=>({...s,nextLessonPlan:t.target.value})),placeholder:"Outline what you plan to cover in the second trial lesson based on today's assessment...",helperText:`${d.nextLessonPlan.trim().split(/\s+/).filter(t=>t).length} words (minimum 30 required)`,sx:{mb:3}}),e.jsxs(r,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(Oe,{sx:{mr:1}}),"Recommended Resources (Optional)"]}),Re?e.jsx(f,{size:24}):e.jsx(m,{sx:{maxHeight:200,overflow:"auto",border:1,borderColor:"divider",borderRadius:1,p:1,mb:2},children:B.length===0?e.jsx(r,{color:"text.secondary",sx:{p:2},children:"No resources available for this subject"}):B.map(t=>{var s;return e.jsx(X,{control:e.jsx(Le,{checked:d.attachedResourceIds.includes(t.id),onChange:()=>_e(t.id,"diagnostic")}),label:e.jsxs(m,{children:[e.jsx(r,{variant:"body2",fontWeight:"bold",children:t.title}),e.jsxs(r,{variant:"caption",color:"text.secondary",children:[t.description," • ",((s=t.subjects)==null?void 0:s.name)||"General"]})]}),sx:{display:"block",mb:1}},t.id)})}),d.attachedResourceIds.length>0&&e.jsx(p,{label:"Resource Usage Notes",multiline:!0,rows:2,fullWidth:!0,value:d.usageNotes,onChange:t=>W(s=>({...s,usageNotes:t.target.value})),placeholder:"How do you recommend the student use these resources?",sx:{mb:2}}),e.jsx(y,{severity:"info",sx:{mt:2},children:"This diagnostic will be automatically sent to the parent via email with your assessment and recommendations."})]})}),e.jsxs(Q,{children:[e.jsx(u,{onClick:()=>q(!1),children:"Cancel"}),e.jsx(u,{variant:"contained",onClick:at,disabled:b,startIcon:b?e.jsx(f,{size:20}):null,children:"Submit Diagnostic"})]})]}),e.jsxs(F,{open:Ye,onClose:()=>U(!1),maxWidth:"md",fullWidth:!0,children:[e.jsxs(Z,{children:["🎯 Second Trial Lesson - Teaching Reflection",e.jsx(r,{variant:"subtitle2",color:"text.secondary",children:"Reflect on your teaching approach and provide program recommendations"})]}),e.jsx(K,{children:e.jsxs(m,{sx:{mt:2},children:[e.jsx(p,{label:"Teaching Development Reflection",multiline:!0,rows:4,fullWidth:!0,value:x.teachingReflection,onChange:t=>N(s=>({...s,teachingReflection:t.target.value})),placeholder:"Reflect on how your teaching approach evolved between the first and second lessons. What worked well? What would you adjust?",sx:{mb:3}}),e.jsx(p,{label:"Long-term Program Recommendation",multiline:!0,rows:4,fullWidth:!0,value:x.longTermProgram,onChange:t=>N(s=>({...s,longTermProgram:t.target.value})),placeholder:"If the student continues with permanent lessons, outline your recommended long-term learning program and goals...",sx:{mb:3}}),e.jsxs(r,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(Oe,{sx:{mr:1}}),"Long-term Resources (Optional)"]}),Re?e.jsx(f,{size:24}):e.jsx(m,{sx:{maxHeight:200,overflow:"auto",border:1,borderColor:"divider",borderRadius:1,p:1,mb:2},children:B.length===0?e.jsx(r,{color:"text.secondary",sx:{p:2},children:"No resources available for this subject"}):B.map(t=>{var s;return e.jsx(X,{control:e.jsx(Le,{checked:x.attachedResourceIds.includes(t.id),onChange:()=>_e(t.id,"reflection")}),label:e.jsxs(m,{children:[e.jsx(r,{variant:"body2",fontWeight:"bold",children:t.title}),e.jsxs(r,{variant:"caption",color:"text.secondary",children:[t.description," • ",((s=t.subjects)==null?void 0:s.name)||"General"]})]}),sx:{display:"block",mb:1}},t.id)})}),x.attachedResourceIds.length>0&&e.jsx(p,{label:"Resource Usage Notes",multiline:!0,rows:2,fullWidth:!0,value:x.usageNotes,onChange:t=>N(s=>({...s,usageNotes:t.target.value})),placeholder:"How would these resources support the long-term program?",sx:{mb:2}}),e.jsx(y,{severity:"info",sx:{mt:2},children:"Your reflection will help parents decide whether to continue with permanent lessons."})]})}),e.jsxs(Q,{children:[e.jsx(u,{onClick:()=>U(!1),children:"Cancel"}),e.jsx(u,{variant:"contained",onClick:ot,disabled:b,startIcon:b?e.jsx(f,{size:20}):null,children:"Submit Reflection"})]})]}),e.jsxs(F,{open:qe,onClose:oe,fullWidth:!0,maxWidth:"md",children:[e.jsx(Z,{children:"Set Your Availability for Permanent Lessons"}),e.jsxs(K,{children:[e.jsx(Fe,{sx:{mb:2},children:"Great news! The student wants to continue with permanent lessons. Please set your available times below. Most lessons continue at the same time as the trial, but providing multiple options helps us find the best time for everyone."}),e.jsx(p,{margin:"dense",label:"Preferred Time (Optional)",fullWidth:!0,value:ve,onChange:t=>ne(t.target.value),placeholder:"e.g., Same as trial time, or Wednesday at 4:00 PM",sx:{mb:2}}),e.jsxs(m,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(r,{variant:"h6",children:"Available Time Slots"}),e.jsx(u,{startIcon:e.jsx(Tt,{}),onClick:st,variant:"outlined",children:"Add Time Slot"})]}),v.length===0&&e.jsx(y,{severity:"info",sx:{mb:2},children:`Click "Add Time Slot" to specify when you're available for permanent lessons.`}),v.map((t,s)=>e.jsxs(ee,{container:!0,spacing:2,sx:{mb:2,alignItems:"center"},children:[e.jsx(ee,{item:!0,xs:4,children:e.jsxs(kt,{fullWidth:!0,size:"small",children:[e.jsx(Dt,{children:"Day"}),e.jsx(It,{value:t.day,label:"Day",onChange:n=>De(s,"day",n.target.value),children:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map(n=>e.jsx(vt,{value:n,children:n},n))})]})}),e.jsx(ee,{item:!0,xs:6,children:e.jsx(p,{fullWidth:!0,size:"small",label:"Time",type:"time",value:t.time,onChange:n=>De(s,"time",n.target.value),InputLabelProps:{shrink:!0}})}),e.jsx(ee,{item:!0,xs:2,children:e.jsx(wt,{color:"error",onClick:()=>nt(s),children:e.jsx(Rt,{})})})]},s)),e.jsx(r,{variant:"body2",color:"textSecondary",sx:{mt:2},children:"Please provide at least one available time slot. The admin will review your availability and coordinate with the student to find the best time."})]}),e.jsxs(Q,{children:[e.jsx(u,{onClick:oe,disabled:b,children:"Cancel"}),e.jsx(u,{onClick:it,variant:"contained",disabled:b||v.length===0,children:b?e.jsx(f,{size:24}):"Submit Availability"})]})]}),e.jsxs(F,{open:Be,onClose:ae,fullWidth:!0,maxWidth:"sm",children:[e.jsx(Z,{children:"Submit Lesson Feedback"}),e.jsxs(K,{children:[e.jsx(Fe,{sx:{mb:2},children:"Please provide brief feedback on how the trial lesson went and indicate whether it was successful."}),e.jsx(_t,{component:"legend",sx:{mb:1,fontWeight:"bold"},children:"Was this trial lesson successful?"}),e.jsxs(Pt,{value:J,onChange:t=>Te(t.target.value),sx:{mb:2},children:[e.jsx(X,{value:"successful",control:e.jsx(Ae,{}),label:"✅ Successful - Student will likely continue"}),e.jsx(X,{value:"unsuccessful",control:e.jsx(Ae,{}),label:"❌ Unsuccessful - Student unlikely to continue"})]}),e.jsx(p,{margin:"dense",id:"feedback",label:"Detailed Lesson Feedback",type:"text",fullWidth:!0,multiline:!0,rows:4,value:G,onChange:t=>Ce(t.target.value),placeholder:"Please describe how the lesson went, what topics were covered, and any observations about the student's engagement..."})]}),e.jsxs(Q,{children:[e.jsx(u,{onClick:ae,disabled:b,children:"Cancel"}),e.jsx(u,{onClick:ct,variant:"contained",disabled:b||!G||!J,children:b?e.jsx(f,{size:24}):"Submit Feedback"})]})]})]})}export{Kt as default};
